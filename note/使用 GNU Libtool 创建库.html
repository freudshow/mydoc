<!DOCTYPE html>
<!-- saved from url=(0078)https://www.ibm.com/developerworks/cn/aix/library/1007_wuxh_libtool/index.html -->
<html lang="zh-CN" style="" class="applicationcache geolocation history postmessage svg websockets localstorage sessionstorage websqldatabase webworkers hashchange pointerevents canvas audio canvastext video webgl cssgradients multiplebgs opacity rgba inlinesvg hsla supports svgclippaths smil no-touchevents fontface generatedcontent textshadow cssanimations backgroundsize borderimage borderradius boxshadow csscolumns csscolumns-width csscolumns-span csscolumns-fill csscolumns-gap csscolumns-rule csscolumns-rulecolor csscolumns-rulestyle csscolumns-rulewidth csscolumns-breakbefore csscolumns-breakafter csscolumns-breakinside flexbox flexboxlegacy cssreflections csstransforms csstransforms3d csstransitions indexeddb indexeddb-deletedatabase js ibm-v18 ibm-cxtype-3g no-hires linux chrome chrome6 webkit webkit5 ibm-grid-xlarge greater-china-imt"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	
<meta name="viewport" content="width=device-width, initial-scale=1">      
<link rel="icon" href="https://www.ibm.com/favicon.ico">
<link rel="canonical" href="http://www.ibm.com/developerworks/cn/aix/library/1007_wuxh_libtool/index.html">
<meta name="geo.country" content="CN">
<meta name="dcterms.rights" content="© Copyright IBM Corporation 2010">
<meta name="dcterms.date" content="2010-07-12">
<meta name="description" content="这篇文档向大家介绍 GNU Libtool 的用途及基本使用方法，同时描述如何结合 GNU Autoconf 和 Automake 来使用 Libtool。">	
<meta name="keywords" content="GNU libtool, shared object, library, loadable module, plugin, 动态链接库, dddauca">
<meta name="robots" content="index,follow">
<title>使用 GNU Libtool 创建库</title>
    
<script type="text/javascript" async="" charset="utf-8" id="utag_19" src="./使用 GNU Libtool 创建库_files/hotjar-42920.js"></script><script type="text/javascript" async="" charset="utf-8" id="utag_53" src="./使用 GNU Libtool 创建库_files/js"></script><script type="text/javascript" async="" charset="utf-8" id="tealium_cormetrics2" src="./使用 GNU Libtool 创建库_files/eluminate.js"></script><script type="text/javascript" async="" charset="utf-8" id="dle_api_d6b469d4573cac9d70652ea0746131ef84c0fd3c039ad58cfc6746359201305b" src="./使用 GNU Libtool 创建库_files/p_d6b469d4573cac9d70652ea0746131ef84c0fd3c039ad58cfc6746359201305b.js"></script><script src="./使用 GNU Libtool 创建库_files/p_devwrks.js" type="application/javascript" async=""></script><script src="./使用 GNU Libtool 创建库_files/p_devwrks.js" type="application/javascript" async=""></script><script src="./使用 GNU Libtool 创建库_files/analytics-marketing.js" type="text/javascript" async=""></script><script src="./使用 GNU Libtool 创建库_files/bluemix-analytics.min.js" type="application/javascript" async=""></script><script src="./使用 GNU Libtool 创建库_files/callback=_dl.fn.lotameApi.callback" type="application/javascript" async=""></script><script src="./使用 GNU Libtool 创建库_files/utag.js" type="application/javascript" async=""></script><script> 
    digitalData = {
        "page":{
            "category":{
                "primaryCategory":"SOFDCAIXCN"
            },
            "pageInfo":{
                "effectiveDate":"2010-07-12",
                "language":"zh-CN",
                "publishDate":"2010-07-12",
                "publisher":"IBM Corporation",
                "version":"v18",
                "ibm":{ 
                    "contentDelivery":"IBM developerWorks template",
                    "contentProducer":"IBM developerWorks",
                    "country":"CN",
                    "owner":"developerWorks/China/IBM",
                    "siteID":"DEVWRKS",
                    "subject":"SWG10",
                    "type":"CT316",
                    "topic":"应用开发,操作系统,移植,工具与及实用程序",
                    "topicId":"263,347,470,352",
                    "contentArea":"aix",
                    "contentAreaId":"34",
                    "contentType":"article",
                    "contentId":"499997",
                },
                "keywords":"GNU libtool, shared object, library, loadable module, plugin, 动态链接库, dddauca",
                "description":"这篇文档向大家介绍 GNU Libtool 的用途及基本使用方法，同时描述如何结合 GNU Autoconf 和 Automake 来使用 Libtool。"
            }
        }
    };
    window._analytics = {
        "coremetrics": false,
        "optimizely": false,
        "googleAddServices": false,
        "addRoll": false,
        "intercom": false,
        "fullStory": false,
        "hotjar": false,
        "tealeaf": false,
        "nps": false,
        "segment_key": 'HU3dbkAG5wE0F1IkRf9S1RexlAqo3jby'
    };
</script>
	
    <meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@developerworks">
<meta property="og:title" content="使用 GNU Libtool 创建库">
<meta property="og:description" content="这篇文档向大家介绍 GNU Libtool 的用途及基本使用方法，同时描述如何结合 GNU Autoconf 和 Automake 来使用 Libtool。">
    <meta property="og:image" content="http://www.ibm.com/developerworks/i/dw-social-201508.png">
<!-- Segment meta tag -->
<meta name="segment" property="developerWorks (developerWorks)" producttitle="developerWorks" value="AIX and UNIX Chinese (developerWorks)">      
<!-- SITE MON : START (DO NOT DELETE) -->
<!-- developerWorks monitoring token -->
<!-- SITE MON : END (DO NOT DELETE) -->

<!-- HEADER_SCRIPTS_AND_CSS_INCLUDE -->
<!-- <script src="//cdn.optimizely.com/js/5399420604.js"></script> -->
<!-- BEGIN: Use this section to set page specific variables for the Page Tag -->
<script language="JavaScript">var NTPT_PGEXTRA="ibmSkillLevel=3&ibmCmaId=499997&ibmContentAreas=aix";</script>
<!--END -->
<script src="./使用 GNU Libtool 创建库_files/ida_stats.js"></script>
<link href="./使用 GNU Libtool 创建库_files/www.css" rel="stylesheet">
<link href="./使用 GNU Libtool 创建库_files/syntaxhighlighter.css" rel="stylesheet">
<script src="./使用 GNU Libtool 创建库_files/www.js"></script><style></style>
<script src="./使用 GNU Libtool 创建库_files/syntaxhighlighter.js"></script>    
<link href="./使用 GNU Libtool 创建库_files/tables.css" rel="stylesheet">
<script src="./使用 GNU Libtool 创建库_files/tables.js"></script>   
<!--  Masthead/footer  -->
<link href="./使用 GNU Libtool 创建库_files/dw-mf-v18.css" rel="stylesheet">
<!-- <link href="//dw1.s81c.com/developerworks/css/dw-mf/v18/alt-signedin-ux.css" rel="stylesheet" /> -->   
<!--[if lt IE 9]>
    <link href="//dw1.s81c.com/developerworks/css/dw-mf/v18/dw-mf-ie8fix.css?v=022216" rel="stylesheet" />
<![endif]-->
<link href="./使用 GNU Libtool 创建库_files/dw-article.css" rel="stylesheet">
<script src="./使用 GNU Libtool 创建库_files/dw-auth-properties.js"></script>
<script src="./使用 GNU Libtool 创建库_files/dw-auth.js"></script>
<script src="./使用 GNU Libtool 创建库_files/dw-mf.js"></script>
<script src="./使用 GNU Libtool 创建库_files/dw-include.js"></script>     
<script src="./使用 GNU Libtool 创建库_files/dw-article.js"></script>
<script src="./使用 GNU Libtool 创建库_files/dw-auto-links.js"></script>     
<script src="./使用 GNU Libtool 创建库_files/tactic.js"></script>
<script src="./使用 GNU Libtool 创建库_files/tacticbindlinks.js"></script>

<!-- 
<PageMap>
    <DataObject type="document">
        <Attribute name="topic">应用开发,操作系统,移植,工具与及实用程序</Attribute>
        <Attribute name="topicId">263,347,470,352</Attribute>
        <Attribute name="contentArea">aix</Attribute>
        <Attribute name="contentAreaId">34</Attribute>
        <Attribute name="abstract">这篇文档向大家介绍 GNU Libtool 的用途及基本使用方法，同时描述如何结合 GNU Autoconf 和 Automake 来使用 Libtool。</Attribute>
        <Attribute name="pub.date">2010-07-12</Attribute>
        <Attribute name="contentType">article</Attribute>
    </DataObject>
</PageMap>
-->        

<style id="ibm-masthead-hidelinks">@media screen and (max-width: 552px) { .ibm-masthead-categories,#ibm-megamenu-sections{display:none} }@media screen and (max-width: 552px) { .ibm-mh-marketplace-link{display:none} }</style><script type="text/javascript" async="" charset="utf-8" id="utag_ibm.web_53" src="./使用 GNU Libtool 创建库_files/utag.53.js"></script><style id="ibm-sitenav-menu-hidelinks">@media screen and (max-width: 694px) {.ibm-sitenav-menu-container .ibm-sitenav-menu-list > ul > li {display:none}.ibm-sitenav-menu-list > ul > .ibm-sitenav-menu-item-right {display:block}}@media screen and (min-width: 695px) {.ibm-mobilemenu-sitenavmenu > ul > li {display:none}}@media screen and (max-width: 343px) {.ibm-sitenav-menu-list > ul > .ibm-sitenav-menu-item-right {display:none}}@media screen and (min-width: 344px) {.ibm-mobilemenu-sitenavmenu > ul > .ibm-sitenav-menu-item-right {display:none}}</style><style type="text/css" class="jquery-comments-css">.jquery-comments ul.navigation li.active:after {background: #2793e6 !important;</style><style type="text/css" class="jquery-comments-css">.jquery-comments ul.navigation ul.dropdown li.active {background: #2793e6 !important;</style><style type="text/css" class="jquery-comments-css">.jquery-comments .highlight-background {background: #2793e6 !important;</style><style type="text/css" class="jquery-comments-css">.jquery-comments .highlight-font {color: #2793e6 !important;}</style><style type="text/css" class="jquery-comments-css">.jquery-comments .highlight-font-bold {color: #2793e6 !important;font-weight: bold;}</style><script type="text/javascript" async="" charset="utf-8" id="utag_ibm.web_19" src="./使用 GNU Libtool 创建库_files/utag.19.js"></script><script type="text/javascript" async="" charset="utf-8" id="LOTCC_10026" src="https://tags.crwdcntrl.net/c/10026/cc.js?ns=_cc10026&amp;pre=cn"></script><script type="text/javascript" async="" charset="utf-8" id="utag_ibm.web_45" src="./使用 GNU Libtool 创建库_files/utag.45.js"></script><style type="text/css">@media only screen and (max-width:480px){.truste_box_overlay{width: 100%!important;margin: 0px!important;max-width: 100%!important;box-shadow: rgb(0,0,0,0.2) 0px 0px 16px 2px!important;}}@media only screen and (min-width:481px){.truste_box_overlay{width: 80%!important;margin: 20px auto!important;max-width: 800px!important;box-shadow: rgb(0,0,0,0.2) 0px 0px 16px 2px!important;}}</style><style type="text/css">@font-face {font-family: "ibm-plex-sans"; src: url("https://1.www.s81c.com/common/fonts/plex/v1/ibmplexsans-regular.woff2") format("woff2");font-family: "ibm-plex-sans"; src: url("https://1.www.s81c.com/common/fonts/plex/v1/ibmplexsans-regular.woff") format("woff");}</style><script language="javascript" type="text/javascript" src="./使用 GNU Libtool 创建库_files/50200000.js"></script><script language="javascript" type="text/javascript" src="./使用 GNU Libtool 创建库_files/rules_50200000.js"></script><script language="javascript" type="text/javascript" src="./使用 GNU Libtool 创建库_files/dispatcher-v3.js"></script><script src="./使用 GNU Libtool 创建库_files/yahoo-min.js" type="text/javascript"></script><script src="./使用 GNU Libtool 创建库_files/cp-v3.js" type="text/javascript"></script><script src="./使用 GNU Libtool 创建库_files/json-min.js" type="text/javascript"></script><script async="" src="./使用 GNU Libtool 创建库_files/modules-cf5028eda4f4b4aeb82e5b7555a3b16e.js"></script><style type="text/css">iframe#_hjRemoteVarsFrame {display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;}</style><style type="text/css">.truste_cookie_prefs,#teconsent{display:none !important}</style><script type="text/javascript" async="" charset="utf-8" id="tealium_visitor_service_45main" src="./使用 GNU Libtool 创建库_files/0163b42f510b002331a6dc7000e80406900260610093c"></script></head>
<body id="ibm-com" class="ibm-type ibm-sitenav-menu ibm-sitenav-menu-sticky ibm-masthead-sticky ibm-masthead-sticky-showing">
	
<div id="ibm-top" class="ibm-landing-page">

<!-- MASTHEAD_BEGIN -->
<div id="ibm-masthead" role="banner" aria-label="IBM" class="ibm-mhtype-minimal hastransition">
    <div id="ibm-universal-nav" class="">    
  
        <nav role="navigation" aria-label="IBM">
            <div id="ibm-home"><a href="https://www.ibm.com/cn/zh/?lnk=m">IBM®</a></div>
            <ul id="ibm-menu-links" role="toolbar" aria-label="Site map" class="ibm-hide">
                <li><a href="https://www.ibm.com/sitemap/cn/zh/">站点地图</a></li>
            </ul><div class="ibm-masthead-rightside"><p class="ibm-mh-marketplace-link ibm-button-link ibm-fleft ibm-padding-bottom-0"><a class="ibm-btn-small ibm-btn-sec ibm-btn-blue-50" href="https://www.ibm.com/cn-zh/marketplace?lnk=mp">市场</a></p><div id="ibm-search-module" role="search" aria-labelledby="ibm-masthead" class="ibm-has-scope">
            <div class="ibm-masthead-search-close"><p class="ibm-ind-link ibm-icononly ibm-padding-bottom-0"><a href="https://www.ibm.com/developerworks/cn/aix/library/1007_wuxh_libtool/index.html#" class="ibm-close-link ibm-nospacing">关闭</a></p></div><form id="ibm-search-form" action="https://www.ibm.com/Search/" method="get" aria-labelledby="ibm-masthead">
                <p>
                    <label for="q">IBM</label>
                    <input type="text" maxlength="100" value="" placeholder="搜索" name="q" id="q" aria-label="搜索 developerWorks" autocomplete="off" role="combobox" aria-autocomplete="list" aria-expanded="false" aria-owns="ibm-search-typeahead-container"><input name="lnk" type="hidden" value="mhsrch">
                    <input type="hidden" value="18" name="v">
                    <input type="hidden" value="utf" name="en">
                    <input type="hidden" value="zh" name="lang">
                    <input type="hidden" value="cn" name="cc">
                    <input type="hidden" name="sn" value="dw">
                    <input type="hidden" name="dws" value="cndw">
                    <input type="hidden" name="hpp" value="20">
                    <span class="ibm-search-scope ibm-fadeout" aria-expanded="true"><input class="ibm-styled-checkbox" data-init="false" type="checkbox" name="sn" value="" id="ibm-mh-scopeoption"> <label for="ibm-mh-scopeoption">In Marketplace</label></span><button role="button" type="submit" id="ibm-search" class="ibm-search-link" value="提交"><span class="ibm-access">提交</span></button>
                </p>
            </form><form class="ibm-hide" id="ibm-default-scope-form" action="https://www.ibm.com/marketplace/search/cn/zh-cn" method="get"><input name="terms" type="text"><input name="lnk" type="hidden" value="mhmpsrch"></form>
        </div><div id="ibm-search-typeahead-container" aria-expanded="true" class="ibm-search-typeahead-container ibm-fadeout"></div><ul aria-label="Tools" role="menubar" class="ibm-masthead-iconsonly"><li role="presentation" class="ibm-masthead-item-signin"><button role="button" aria-haspopup="true" aria-owns="ibm-signin-minimenu-container" class="ibm-profile-link">我的 IBM</button><ul id="ibm-signin-minimenu-container" role="menu" aria-label="Profile" class="ibm-dropdown-menu">    <li class="ibm-dropdown-menu-primary" role="presentation" data-linktype="notifications">       <a class="" href="https://myibm.ibm.com/dashboard/?lnk=mmi" tabindex="0">我的 IBM</a>     </li>    <li class="ibm-dropdown-menu-primary menu-heading" role="presentation">       <span tabindex="0">developerWorks</span>     </li>   <li class="ibm-dropdown-menu-primary ibm-signin-alt" role="presentation">     <a href="https://www.ibm.com/developerworks/dwwi/jsp/ssologin.jsp?d=https%3A%2F%2Fwww.ibm.com%2Fdeveloperworks%2Fcn%2Faix%2Flibrary%2F1007_wuxh_libtool%2Findex.html&amp;lang=zh&amp;a=dwmav" role="menuitem">登录</a>   </li>   <li class="ibm-dropdown-menu-primary dw-register-alt" role="presentation">     <a href="https://www.ibm.com/developerworks/dwwi/jsp/ssoregister.jsp?d=https%3A%2F%2Fwww.ibm.com%2Fdeveloperworks%2Fcn%2Faix%2Flibrary%2F1007_wuxh_libtool%2Findex.html&amp;lang=zh&amp;a=dwmav" role="menuitem">注册</a>   </li></ul></li><li role="presentation" class="ibm-masthead-item-menu"><button role="button" aria-haspopup="true" aria-owns="ibm-burger-menu-container" class="ibm-menu-link">站点导航</button></li></ul></div> 
        </nav>
  
        
       
    </div>
</div><div class="ibm-mobilemenu ibm-hide" id="ibm-burger-menu-container" aria-labelledby="ibm-burgermenu-a11y" role="dialog" tabindex="0"><p class="ibm-hide" id="ibm-burgermenu-a11y">站点导航</p><div class="ibm-mobilemenu-close"><p class="ibm-icononly ibm-fright ibm-ind-link ibm-nospacing"><a class="ibm-close-link" href="https://www.ibm.com/developerworks/cn/aix/library/1007_wuxh_libtool/index.html?lnk=hm#">关闭</a></p></div><div class="ibm-mobilemenu-section ibm-mobilemenu-sitenavmenu"><ul role="menubar"><li class="ibm-mobile-section-heading ibm-mobile-sitename">
        <a href="https://www.ibm.com/developerworks/cn/?lnk=hm">
            <img width="186" height="24" alt="developerWorks®" src="./使用 GNU Libtool 创建库_files/dw-mf-wordmark.svg">
        </a>
    </li>
                            <li class="dw-navpage-learn" role="presentation">
                    <a href="https://www.ibm.com/developerworks/cn/topics/?lnk=hm" role="menuitem" tabindex="0">学习</a>
                </li>
                    
                <li class="dw-navpage-develop" role="presentation">
                    <a href="https://www.ibm.com/developerworks/cn/downloads/?lnk=hm" role="menuitem" tabindex="-1">开发</a>
                </li>                    

                <li class="dw-navpage-connect" role="presentation">
                    <a href="https://www.ibm.com/developerworks/cn/community/?lnk=hm" role="menuitem" tabindex="-1">社区</a>
                </li>
                <li class="ibm-sitenav-menu-item-right">
                    <a href="https://www.ibm.com/ibm/cn/partners/start/?lnk=hm" role="menuitem" tabindex="-1">合作</a>
                </li>
        </ul></div><div class="ibm-mobilemenu-section"><ul class="ibm-mobilemenu-mhlinks" aria-label="发现 IBM"><li><a href="https://www.ibm.com/cn-zh/marketplace?lnk=hmmp">市场</a></li><li><div data-widget="showhide" data-type="panel" class="ibm-show-hide ibm-widget-processed"><h2><a href="javascript:void();">产品</a></h2><div class="ibm-container-body" style="display: none;"><ul><li><a href="https://www.ibm.com/products/cn/zh/?lnk=hmhmpr_cnzh"><span>产品</span></a></li><li><a href="https://www.ibm.com/analytics/cn/zh/?lnk=hmmpr_bua_cnzh&amp;lnk2=learn"><span>大数据与分析</span></a></li><li><a href="https://www.ibm.com/cloud-computing/cn/zh?lnk=hmmpr_bucl_cnzh&amp;lnk2=learn"><span>云计算</span></a></li><li><a href="https://www.ibm.com/ibm/cn/cognitive/outthink/?lnk=hmmpr_buce_cnzh&amp;lnk2=learn"><span>认知</span></a></li><li><a href="https://www.ibm.com/watson/customer-engagement/cn-zh/?lnk=hm"><span>认知客户互动</span></a></li><li><a href="https://www.ibm.com/internet-of-things/cn-zh/?lnk=hmmpr_iot_cnzh&amp;lnk2=learn"><span>物联网</span></a></li><li><a href="https://www.ibm.com/solutions/cn/zh/index.html?lnk=hm"><span>行业解决方案</span></a></li><li><a href="https://www.ibm.com/it-infrastructure/cn-zh/?lnk=hmmpr_buit_cnzh&amp;lnk2=learn"><span>IT 基础架构</span></a></li><li><a href="https://www.ibm.com/mobilefirst/cn/zh/?lnk=hmmpr_bumf_cnzh&amp;lnk2=learn"><span>移动</span></a></li><li><a href="https://www.ibm.com/security/cn-zh/?lnk=hmmpr_buse_cnzh&amp;lnk2=learnquick"><span>IBM 安全</span></a></li><li><a href="https://www.ibm.com/social-business/cn-zh/?lnk=hm"><span>社交协作与人才管理</span></a></li><li><a href="https://www.ibm.com/services/cn/zh/watson/explorer.html?lnk=hm"><span>Watson</span></a></li></ul></div></div></li><li><div data-widget="showhide" data-type="panel" class="ibm-show-hide ibm-widget-processed"><h2><a href="javascript:void();">服务</a></h2><div class="ibm-container-body" style="display: none;"><ul><li><a href="https://www.ibm.com/services/cn-zh/digital-reinvention/case/index.html?lnk=hm"><span>业务咨询</span></a></li><li><a href="https://www.ibm.com/technologyservices/cn/zh/?lnk=hmmse_ts_cnzh&amp;lnk2=learn#technology-outsourcing"><span>技术服务</span></a></li><li><a href="https://www.ibm.com/financing/cn/zh/index.html?lnk=hmmse_fin_cnzh&amp;lnk2=learn"><span>融资</span></a></li><li><a href="https://www.ibm.com/solutions/cn/zh/index.html?lnk=hm"><span>行业解决方案</span></a></li><li><a href="https://www.ibm.com/training/?lnk=hm"><span>培训与技能 (US)</span></a></li></ul></div></div></li><li><a href="https://www.ibm.com/solutions/cn/zh/?lnk=hmmin">行业</a></li><li><div data-widget="showhide" data-type="panel" class="ibm-show-hide ibm-widget-processed"><h2><a href="javascript:void();">开发人员</a></h2><div class="ibm-container-body" style="display: none;"><ul><li><a href="https://www.ibm.com/developerworks/cn/?lnk=hmmdev_dw_cnzh&amp;lnk2=learn"><span>developerWorks</span></a></li><li><a href="https://www.ibm.com/partnerworld?lnk=hmmdev_pw_cnzh&amp;lnk2=learn"><span>PartnerWorld</span></a></li><li><a href="https://www.ibm.com/ibm/cn/partners/start/?masthead=&amp;lnk=hm"><span>云/AI 合作伙伴</span></a></li></ul></div></div></li><li><a href="https://www.ibm.com/support/cn/zh/?lnk=hmmsu_cnzh">支持</a></li><li><a href="https://www.ibm.com/employment/cn/?lnk=hmmca_cnzh">工作机会</a></li></ul></div></div><div class="ibm-mhplaceholder"></div><!-- MASTHEAD_END -->
	    
<!-- LAYOUT -->
<div id="ibm-content-wrapper">
    <!-- LEADSPACE_BEGIN -->
    <header role="banner" aria-labelledby="ibm-pagetitle-h1">
        
        <!-- MASTHEAD_SITENAV_BEGIN -->
        <div class="ibm-sitenav-menu-container" data-widgetprocessed="true">
    <div class="ibm-sitenav-menu-name">
        <a href="https://www.ibm.com/developerworks/cn/">
            <img width="186" height="24" alt="developerWorks®" src="./使用 GNU Libtool 创建库_files/dw-mf-wordmark.svg">
        </a>
    </div>
    <div class="ibm-sitenav-menu-list">
        <ul role="menubar">
                            <li class="dw-navpage-learn" role="presentation">
                    <a href="https://www.ibm.com/developerworks/cn/topics/" role="menuitem" tabindex="0">学习</a>
                </li>
                    
                <li class="dw-navpage-develop" role="presentation">
                    <a href="https://www.ibm.com/developerworks/cn/downloads/" role="menuitem" tabindex="-1">开发</a>
                </li>                    

                <li class="dw-navpage-connect" role="presentation">
                    <a href="https://www.ibm.com/developerworks/cn/community/" role="menuitem" tabindex="-1">社区</a>
                </li>
                <li class="ibm-sitenav-menu-item-right">
                    <a href="https://www.ibm.com/ibm/cn/partners/start/" role="menuitem" tabindex="-1">合作</a>
                </li>
        </ul>
    </div>
</div>        <!-- MASTHEAD_SITENAV_END -->
        
        <!-- NAVIGATION_TRAIL_BEGIN -->
        <div id="ibm-leadspace-head" class="ibm-alternate">
            <div id="ibm-leadspace-body">
                <nav aria-label="Breadcrumb" role="navigation">                     
                            <ul id="dw-navigation-trail" itemscope="" itemtype="http://schema.org/BreadcrumbList"><li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem"><a itemprop="item" href="http://www.ibm.com/developerworks/cn/topics/"><span itemprop="name">学习</span></a><meta itemprop="position" content="1"></li><li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem"><a itemprop="item" href="http://www.ibm.com/developerworks/cn/aix/"><span itemprop="name">AIX and UNIX</span></a><meta itemprop="position" content="2"></li></ul>
                </nav>
            </div>
        </div>
        <!-- NAVIGATION_TRAIL_END -->
        
    </header>
    <!-- LEADSPACE_END -->
    
    <!-- MAIN_CONTENT_BEGIN -->
    <main role="main" aria-label=""> 
        <div id="ibm-pcon">
            <!-- BEGIN_IBM-CONTENT -->
            <div id="ibm-content">
                <!-- BEGIN_IBM-CONTENT-BODY -->
                <div id="ibm-content-body">
                    <!-- BEGIN_IBM-CONTENT-MAIN -->
                    <div id="ibm-content-main" class="dw-article">                        
                        <!-- BEGIN_INTERIOR-COLUMNS -->
                                <div class="ibm-columns dw-article-toc">
                                    <!-- LEFT_6_2_CONTENT_COLUMN_BEGIN -->  
                                    <div id="dw-article-toc-container" class="ibm-col-6-2">
                                        <div id="dw-article-toc-body" data-widget="scrollable" data-height="512" style="width: 380px; height: 512px;" class="ibm-widget-processed"><div class="nano-content" tabindex="-1" style="right: -15px;">
                                            <h2>内容</h2><div class="ibm-alternate-rule"><hr></div><ul role="directory" aria-label="内容" class="ibm-plain-list"><li class=""><a onclick="tocLink(&#39;#ibm-pagetitle-h1&#39;)" role="link" tabindex="0">概览</a></li><li class=""><a onclick="tocLink(&#39;#major1&#39;)" role="link" tabindex="0">介绍</a></li><li class="dw-highlight"><a onclick="tocLink(&#39;#major2&#39;)" role="link" tabindex="0">Libtool 基本用法</a></li><li><a onclick="tocLink(&#39;#major3&#39;)" role="link" tabindex="0">Libtool 高级用法</a></li><li><a onclick="tocLink(&#39;#major4&#39;)" role="link" tabindex="0">结合 Autoconf 和 Automake 使用 Libtool</a></li><li><a onclick="tocLink(&#39;#major5&#39;)" role="link" tabindex="0">小结</a></li><li><a onclick="tocLink(&#39;#artrelatedtopics&#39;)" role="link" tabindex="0">相关主题</a></li><li><a onclick="tocLink(&#39;#icomments&#39;)" role="link" tabindex="0">评论</a></li></ul>
                                        </div><div class="nano-pane" style="display: none; opacity: 1; visibility: visible;"><div class="nano-slider" style="height: 497px; transform: translate(0px, 0px);"></div></div></div>
                                    </div>
                                    <!-- LEFT_6_2_CONTENT_COLUMN_END -->
                                    
                                    <!-- CENTER_6_4_CONTENT_COLUMN_BEGIN -->
                                    <div class="ibm-col-6-4">
                                        <h1 id="ibm-pagetitle-h1" class="ibm-h1">使用 GNU Libtool 创建库</h1>
                                        <!-- Article Top Bar -->
                                                <div class="ibm-columns dw-article-topbar">
                                                    <!-- Author and article info. -->
                                                    <div class="ibm-col-6-2 ibm-col-medium-6-4 dw-article-metadata">
                                                        <div class="dw-article-avatar"><img width="42" height="42" src="./使用 GNU Libtool 创建库_files/dw-author.png" alt=""></div><div class="dw-article-authordate">吴 小虎<br><span class="dw-article-pubdate">2010 年 7 月 12 日发布</span></div>
                                                    </div>
                                                    <!-- Social -->
                                                    <div class="ibm-col-6-2 ibm-col-medium-6-4 ibm-col-small-6-2 dw-article-social">
                                                        <!-- Sharing links -->
                                                        <div id="dw-article-share-inline">
                                                            <div class="dw-article-sharelink-inline">
                                                                <div class="ibm-sharethispage"><h4 class="ibm-bold">分享此页面</h4><p class="ibm-icononly"><a class="ibm-weibo-encircled-link" href="http://service.weibo.com/share/share.php?url=http%3A%2F%2Fwww.ibm.com%2Fdeveloperworks%2Fcn%2Faix%2Flibrary%2F1007_wuxh_libtool%2Findex.html%&amp;title=%E4%BD%BF%E7%94%A8%20GNU%20Libtool%20%E5%88%9B%E5%BB%BA%E5%BA%93&amp;language=zh_cn" data-id="weibo" onclick="return IBMCore.common.module.sharethispage.gotoUrl(window.open(), this);">Weibo</a><a class="ibm-googleplus-encircled-link" href="https://plus.google.com/share?url=http%3A%2F%2Fwww.ibm.com%2Fdeveloperworks%2Fcn%2Faix%2Flibrary%2F1007_wuxh_libtool%2Findex.html&amp;t=%E4%BD%BF%E7%94%A8%20GNU%20Libtool%20%E5%88%9B%E5%BB%BA%E5%BA%93" data-id="googleplus" onclick="return IBMCore.common.module.sharethispage.gotoUrl(window.open(), this);">Google+</a><a class="ibm-email-encircled-link" href="mailto:?subject=%E4%BD%BF%E7%94%A8%20GNU%20Libtool%20%E5%88%9B%E5%BB%BA%E5%BA%93&amp;body=http%3A%2F%2Fwww.ibm.com%2Fdeveloperworks%2Fcn%2Faix%2Flibrary%2F1007_wuxh_libtool%2Findex.html" data-id="email" onclick="">用电子邮件发送本页面</a></p></div>
                                                            </div>
                                                        </div>
                                                        <!-- Number of comments and link to comments -->
                                                        <div id="dw-article-cmts">
                                                            <div class="dw-article-cmtslink">
                                                                <a onclick="tocLink(&#39;#icomments&#39;)" href="https://www.ibm.com/developerworks/cn/aix/library/1007_wuxh_libtool/index.html#icomments" role="link" tabindex="0" aria-label="Comments">
                                                                    <img src="./使用 GNU Libtool 创建库_files/dw-article-cmt-icon.png" width="29" height="29" alt="Comments">
                                                                </a>
                                                            </div>
                                                            <div class="dw-article-cmtslink">
                                                                <a onclick="tocLink(&#39;#icomments&#39;)" href="https://www.ibm.com/developerworks/cn/aix/library/1007_wuxh_libtool/index.html#icomments" role="link" tabindex="0">
                                                                    <div id="nCmts">3</div>
                                                                </a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                        <!-- Article Body -->
                                        
                                        <a id="1.|outline"></a><h2 id="major1" class="ibm-h2">介绍</h2><p>在不同的系统中建立动态链接库的方法有很大的差别，这主要是因为每个系统对动态链接库的看法和实现并不相同，以及编译器对动态链接库支持的选项也不太一样。对于开发人员，如果尝试将使用动态库的软件在这些系统之间移植，需要参考枯涩难懂的系统手册，以及修改相应的 Makefile，这一工作是乏味的，并且具有一定的难度。</p><p>使用 GNU Libtool 可以容易的在不同的系统中建立动态链接库。它通过一个称为 Libtool 库的抽象，隐藏了不同系统之间的差异，给开发人员提供了一致的的接口。对于大部分情况，开发人员甚至不用去查看相应的系统手册，只需要掌握 GNU Libtool 的用法就可以了。并且，使用 Libtool 的 Makefile 也只需要编写一次就可以在多个系统上使用。</p><p>Libtool 库可以是一个静态链接库，可以是一个动态链接库，也可以同时包含两者。在这篇文档中，我们围绕 Libtool 库的建立和使用，只是在适当的说明 Libtool 库和系统动态或者静态链接库之间的映射关系。</p><h3 id="minor1.1" class="ibm-h3">Libtool 是一个工具</h3><p>虽然 Libtool 隐藏了在不同平台创建链接库的复杂性，但其最终还是需要底层系统对链接库的支持，它不能超越系统的限制，例如，Libtool 并不能在不支持动态链接库的系统中创建出动态链接库。</p><h2 id="major2" class="ibm-h2">Libtool 基本用法</h2><p>这一节以实例来说明如何使用 Libtool 从源代码创建最终链接库以及执行程序的完整步骤，这是软件开发过程中经常使用的内容，包括 :</p><ul class="ibm-bullet-list"><li>
创建 Libtool 对象文件 ;</li><li>
创建 Libtool 库；</li><li>
安装 Libtool 库 ;</li><li>
使用 Libtool 库 ;</li><li>
卸载 Libtool 库 ;</li></ul><p>首先需要准备一个源文件 compress.c，代码如下：</p><h5 id="listing1" class="ibm-h5">清单 1: compress.c</h5><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_171896" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">#include &lt;</code><code class="htmlscript plain">sys</code><code class="htmlscript plain">/mman.h&gt; </code></div><div class="line number2 index1 alt1"><code class="htmlscript plain">#include &lt;</code><code class="htmlscript plain">sys</code><code class="htmlscript plain">/stat.h&gt; </code></div><div class="line number3 index2 alt2"><code class="htmlscript plain">#include &lt;</code><code class="htmlscript plain">fcntl.h</code><code class="htmlscript plain">&gt; </code></div><div class="line number4 index3 alt1"><code class="htmlscript plain">#include &lt;</code><code class="htmlscript plain">stdio.h</code><code class="htmlscript plain">&gt; </code></div><div class="line number5 index4 alt2"><code class="htmlscript plain">#include &lt;</code><code class="htmlscript plain">stdlib.h</code><code class="htmlscript plain">&gt; </code></div><div class="line number6 index5 alt1"><code class="htmlscript plain">#include &lt;</code><code class="htmlscript plain">unistd.h</code><code class="htmlscript plain">&gt; </code></div><div class="line number7 index6 alt2"><code class="htmlscript plain">#include &lt;</code><code class="htmlscript plain">string.h</code><code class="htmlscript plain">&gt; </code></div><div class="line number8 index7 alt1"><code class="htmlscript plain">#include &lt;</code><code class="htmlscript plain">limits.h</code><code class="htmlscript plain">&gt; </code></div><div class="line number9 index8 alt2"><code class="htmlscript plain">#include &lt;</code><code class="htmlscript plain">assert.h</code><code class="htmlscript plain">&gt; </code></div><div class="line number10 index9 alt1"><code class="htmlscript plain">#include &lt;</code><code class="htmlscript plain">zlib.h</code><code class="htmlscript plain">&gt; </code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="htmlscript plain">/* 一个简单的文件压缩函数 */ </code></div><div class="line number13 index12 alt2"><code class="htmlscript plain">int compress_file (const char *filename) </code></div><div class="line number14 index13 alt1"><code class="htmlscript plain">{ </code></div><div class="line number15 index14 alt2"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">int src_fd, dest_fd; </code></div><div class="line number16 index15 alt1"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">struct stat sb; </code></div><div class="line number17 index16 alt2"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">Bytef *src, *dest; </code></div><div class="line number18 index17 alt1"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">uLong dest_len; </code></div><div class="line number19 index18 alt2"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">char dest_file[PATH_MAX]; </code></div><div class="line number20 index19 alt1">&nbsp;</div><div class="line number21 index20 alt2"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">src_fd = open (filename, O_RDONLY); </code></div><div class="line number22 index21 alt1"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">assert (dest_fd != -1); </code></div><div class="line number23 index22 alt2">&nbsp;</div><div class="line number24 index23 alt1"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">assert (fstat (src_fd, &amp;sb) != -1); </code></div><div class="line number25 index24 alt2">&nbsp;</div><div class="line number26 index25 alt1"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">src = mmap (NULL, sb.st_size, PROT_READ, MAP_PRIVATE, src_fd, 0); </code></div><div class="line number27 index26 alt2"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">assert (src != MAP_FAILED); </code></div><div class="line number28 index27 alt1">&nbsp;</div><div class="line number29 index28 alt2"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">dest_len = compressBound (sb.st_size); </code></div><div class="line number30 index29 alt1"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">dest = malloc (dest_len); </code></div><div class="line number31 index30 alt2"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">assert (dest); </code></div><div class="line number32 index31 alt1">&nbsp;</div><div class="line number33 index32 alt2"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">assert (compress (dest, &amp;dest_len, src, sb.st_size) == Z_OK); </code></div><div class="line number34 index33 alt1">&nbsp;</div><div class="line number35 index34 alt2"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">munmap (src, sb.st_size); </code></div><div class="line number36 index35 alt1"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">close (src_fd); </code></div><div class="line number37 index36 alt2">&nbsp;</div><div class="line number38 index37 alt1"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">snprintf (dest_file, sizeof (dest_file), "%s.z", filename); </code></div><div class="line number39 index38 alt2"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">dest_fd = creat (dest_file, S_IRUSR | S_IWUSR); </code></div><div class="line number40 index39 alt1"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">assert (dest_fd != -1); </code></div><div class="line number41 index40 alt2">&nbsp;</div><div class="line number42 index41 alt1"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">write (dest_fd, dest, dest_len); </code></div><div class="line number43 index42 alt2"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">close (dest_fd); </code></div><div class="line number44 index43 alt1"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">free (dest); </code></div><div class="line number45 index44 alt2">&nbsp;</div><div class="line number46 index45 alt1"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">return 0; </code></div><div class="line number47 index46 alt2"><code class="htmlscript plain">}</code></div></div></td></tr></tbody></table></div></div></div></span><p>这个文件实现了一个函数 <em>compress_file()</em>，它接收一个文件名作为参数，然后对文件进行压缩，生成一个 <em>.z</em>结尾的压缩文件。在这个文件中使用了 <em>compress()</em>函数，这个函数是有由 libz 提供的。</p><p>从源文件建立 Libtool 库需要经过两个步骤，先建立 Libtool 对象文件，再建立 Libtool 库。</p><h3 id="minor2.1" class="ibm-h3">建立 Libtool 对象文件</h3><p>如果使用传统的方式，建立对象文件通常使用下面的命令 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_109576" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ gcc -c compress.c</code></div></div></td></tr></tbody></table></div></div></div></span><p>使用 Libtool 则使用下面的命令 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_80477" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ libtool --mode=compile gcc -c foo.c</code></div></div></td></tr></tbody></table></div></div></div></span><p>可以看到，使用 Libtool 只需要将“传统”的命令 (<em>gcc -c foo.c</em>) 作为参数传递给 Libtool 即可。</p><p>在上面的命令中，libtool 使用 <strong>compile</strong>模式 (--mode=compile 选项 )，这是建立对象文件的模式，Libtool 还有其它的模式，后面将介绍。</p><p>上面的命令输出如下 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_920219" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">mkdir .libs </code></div><div class="line number2 index1 alt1"><code class="htmlscript plain">gcc -c compress.c&nbsp; -fPIC -DPIC -o .libs/compress.o </code></div><div class="line number3 index2 alt2"><code class="htmlscript plain">gcc -c compress.c -o compress.o &gt;/dev/null 2&gt;&amp;1</code></div></div></td></tr></tbody></table></div></div></div></span><p>它建立了两个文件，一个是 .libs/compress.o，在建立这个文件时，Libtool 自动插入了 -<em>fPIC</em>和 -<em>DPIC</em>选项，告诉编译器生成位置独立的代码，之后将用这个文件来建立动态链接库。生成第二个文件 <code><em>compress</em></code><em>.o</em>没有添加额外的选项，它准备用来建立静态链接库。</p><p>除了上面的两个文件之外，Libtool 还建立了一个文件 <strong>compress.lo</strong>，这个文件就是 Libtool 对象文件，实际上也就是一个文本文件，里面记录了建立动态链接库和静态链接库分别所需要的真实文件名称，后面 Libtool 将使用这个文件而不是直接的使用 .libs/compress.o 和 compress.o。</p><h3 id="minor2.2" class="ibm-h3">建立 Libtool 库</h3><p>用下面的命令建立 Libtool 库 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_848819" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ libtool --mode=link gcc -o libcompress.la compress.lo -rpath /tmp -lz</code></div></div></td></tr></tbody></table></div></div></div></span><p>注意这里使用 compress.lo 作为输入文件，并且告诉 Libtool 生成的目标文件为 <strong>libcompress.la</strong>，.la 是 Libtool 的库文件后缀。</p><p>-<em>rpath</em>选项告诉 Libtool 这个库将被安装到什么地方，如果省略了 -<em>rpath</em>选项，那么不会生成动态链接库。</p><p>因为我们的库中使用了 libz 提供的 compress 函数，所以也提供了 -lz 选项，Libtool 会记住这个依赖关系，后续在使用我们的库时自动的将依赖的库链接进来。</p><p>上面的命令输出如下 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_927357" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">gcc -shared&nbsp; .libs/compress.o&nbsp; -lz&nbsp; -Wl,-soname -Wl,libcompress.so.0 </code></div><div class="line number2 index1 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">-o .libs/libcompress.so.0.0.0 </code></div><div class="line number3 index2 alt2"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">(cd .libs &amp;&amp; rm -f libcompress.so.0 &amp;&amp; </code></div><div class="line number4 index3 alt1"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">ln -s libcompress.so.0.0.0 libcompress.so.0) </code></div><div class="line number5 index4 alt2"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">(cd .libs &amp;&amp; rm -f libcompress.so &amp;&amp; </code></div><div class="line number6 index5 alt1"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">ln -s libcompress.so.0.0.0 libcompress.so) </code></div><div class="line number7 index6 alt2"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">ar cru .libs/libcompress.a&nbsp; compress.o </code></div><div class="line number8 index7 alt1"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">ranlib .libs/libcompress.a </code></div><div class="line number9 index8 alt2"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">creating libcompress.la </code></div><div class="line number10 index9 alt1"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">(cd .libs &amp;&amp; rm -f libcompress.la &amp;&amp; </code></div><div class="line number11 index10 alt2"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">ln -s ../libcompress.la libcompress.la)</code></div></div></td></tr></tbody></table></div></div></div></span><p>可以看到，Libtool 自动的插入了建立动态链接库需要的编译选项 -<em>shared</em>。并且，它也建立了静态链接库 .libs/libcompress.a，后面我们将会介绍如何控制 Libtool 只建立需要的库。</p><p>你可能会奇怪为什么建立的动态链接库有 .0 和 .0.0.0 这样的后缀，这里先不用理会它，后面在介绍 Libtool 库版本信息时将会解释这点。</p><p>值得注意的是，Libtool 希望后续使用 libcompress.la 文件而不是直接使用 libcompress.a 和 libcompress.so 文件，如果你这样做，虽然可以，但会破坏 Libtool 库的可移植性。</p><h3 id="minor2.3" class="ibm-h3">安装 Libtool 库</h3><p>如果打算发布建立好的 Libtool 库，可以使用下面的命令安装它 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_176227" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ libtool --mode=install install -c libcompress.la /tmp</code></div></div></td></tr></tbody></table></div></div></div></span><p>我们需要告诉 Libtool 使用的安装命令，Libtool 支持 install 和 cp，这里使用的是 install。</p><p>虽然前面我们在建立库时，通过 -rpath 选项指定了库准备安装的路径 (/tmp)，但是这里我们还得要提供安装路径。请确保它们一致。</p><p>这个命令的输出如下 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_106627" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">install .libs/libcompress.so.0.0.0 /tmp/libcompress.so.0.0.0 </code></div><div class="line number2 index1 alt1"><code class="htmlscript plain">(cd /tmp &amp;&amp; { ln -s -f libcompress.so.0.0.0 libcompress.so.0 || </code></div><div class="line number3 index2 alt2"><code class="htmlscript plain">{ rm -f libcompress.so.0 &amp;&amp; </code></div><div class="line number4 index3 alt1"><code class="htmlscript plain">ln -s libcompress.so.0.0.0 libcompress.so.0; }; }) </code></div><div class="line number5 index4 alt2"><code class="htmlscript plain">(cd /tmp &amp;&amp; { ln -s -f libcompress.so.0.0.0 libcompress.so || </code></div><div class="line number6 index5 alt1"><code class="htmlscript plain">{ rm -f libcompress.so &amp;&amp; ln -s libcompress.so.0.0.0 libcompress.so; }; }) </code></div><div class="line number7 index6 alt2"><code class="htmlscript plain">install .libs/libcompress.lai /tmp/libcompress.la </code></div><div class="line number8 index7 alt1"><code class="htmlscript plain">install .libs/libcompress.a /tmp/libcompress.a </code></div><div class="line number9 index8 alt2"><code class="htmlscript plain">chmod 644 /tmp/libcompress.a </code></div><div class="line number10 index9 alt1"><code class="htmlscript plain">ranlib /tmp/libcompress.a </code></div><div class="line number11 index10 alt2"><code class="htmlscript plain">...</code></div></div></td></tr></tbody></table></div></div></div></span><p>可以看到它安装了真实的动态链接库和静态链接库，同时也安装了 Libtool 库文件 libcompress.la，这个文件可以被后续的 Libtool 命令使用。</p><p>在安装完成之后，可能还需要做一些配置才能正确使用，Libtool 的 finish 模式可以在这方面给我们一些提示 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_871510" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ libtool -n --mode=finish /tmp</code></div></div></td></tr></tbody></table></div></div></div></span><p>这个命令的输出有点长，所以不在这里列出，如果不能正常的使用安装好的库，请运行这个命令。</p><h3 id="minor2.4" class="ibm-h3">使用 Libtool 库</h3><p>要在应用程序中使用前面创建的 Libtool 库很简单，准备一个源文件 main.c，它将使用 libcompress.la 库中定义的函数，代码如下 :</p><h5 id="listing2" class="ibm-h5">清单 2: main.c</h5><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_993233" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">#include &lt;</code><code class="htmlscript plain">stdio.h</code><code class="htmlscript plain">&gt; </code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="htmlscript plain">extern int compress_file (const char *filename); </code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="htmlscript plain">int main (int argc, char *argv[]) </code></div><div class="line number6 index5 alt1"><code class="htmlscript plain">{ </code></div><div class="line number7 index6 alt2"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">if (argc &lt; 2) </code></div><div class="line number8 index7 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">{&nbsp;&nbsp; </code></div><div class="line number9 index8 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">printf ("usage : %s file\n", argv[0]); </code></div><div class="line number10 index9 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">return 1; </code></div><div class="line number11 index10 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">}&nbsp;&nbsp; </code></div><div class="line number12 index11 alt1"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">return compress_file (argv[1]); </code></div><div class="line number13 index12 alt2"><code class="htmlscript plain">}</code></div></div></td></tr></tbody></table></div></div></div></span><p>我们还是要先为 main.c 建立 Libtool 对象文件，这和前面的方法一样 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_849961" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ libtool --mode=compile gcc -c main.c</code></div></div></td></tr></tbody></table></div></div></div></span><h5 id="listing3" class="ibm-h5">使用安装的库</h5><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_758892" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">然后使用下面的命令链接执行文件 : </code></div><div class="line number2 index1 alt1"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">$ libtool --mode=link gcc -o main main.lo /tmp/libcompress.la</code></div></div></td></tr></tbody></table></div></div></div></span><p>我们也可以直接使用 libcompress.a 或者 libcompress.so，但是使用 Libtool 更加简单，因为它会将帮助你解决依赖关系，例如我们的 libcompress 依赖 libz。</p><p>上面命令的输出如下 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_31923" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">gcc -o main .libs/main.o&nbsp; /tmp/libcompress.so -lz </code></div><div class="line number2 index1 alt1"><code class="htmlscript plain">-Wl,--rpath -Wl,/tmp -Wl,--rpath -Wl,/tmp</code></div></div></td></tr></tbody></table></div></div></div></span><p>这里，Libtool 自动选择链接动态链接库，并且加上了运行时需要的 --rpath 选项，以及依赖的库 -lz。</p><p>如果要使用静态链接库，只需要加上 <em>-static-libtool-libs</em>选项即可，如下 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_606428" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ libtool --mode=link&nbsp; gcc&nbsp; -o main main.lo /tmp/libcompress.la -static-libtool-libs</code></div></div></td></tr></tbody></table></div></div></div></span><p>这个命令的输出如下 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_422372" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">gcc -o main .libs/main.o&nbsp; /tmp/libcompress.a -lz</code></div></div></td></tr></tbody></table></div></div></div></span><a id="3.4.3. 使用未安装的库 |outline"></a><p><strong>使用未安装的库</strong></p><p>也可以使用还没有安装的库，这和使用安装好的库几乎相同，只是指定的输入文件位置不一样，假如我们在同一个目录中开发 compress.c 和 main.c，那么使用下面的命令 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_527984" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ libtool --mode=link gcc -o main main.lo ./libcompress.la</code></div></div></td></tr></tbody></table></div></div></div></span><p>和使用安装的库不一样，这个时候建立的 main 程序只是一个封装脚本，如果你直接执行它不会有什么问题，但是如果你想调试它，例如 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_666875" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ gdb main</code></div></div></td></tr></tbody></table></div></div></div></span><p>gdb 会报怨 main 不是可执行格式，不能接受。这个时候我们需要使用 Libtool 的执行模式，使用下面的命令调试程序 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_40509" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ libtool --mode=execute gdb main</code></div></div></td></tr></tbody></table></div></div></div></span><h3 id="minor2.5" class="ibm-h3">卸载 Libtool 库</h3><p>使用下面的命令可以卸载安装的库 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_592098" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ libtool --mode=uninstall rm /tmp/libcompress.la</code></div></div></td></tr></tbody></table></div></div></div></span><p>这个命令的输出如下 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_646933" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">rm /tmp/libcompress.la /tmp/libcompress.so.0.0.0 /tmp/libcompress.so.0 </code></div><div class="line number2 index1 alt1"><code class="htmlscript plain">/tmp/libcompress.so /tmp/libcompress.a</code></div></div></td></tr></tbody></table></div></div></div></span><p>这将删除所有安装的库文件。</p><h2 id="major3" class="ibm-h2">Libtool 高级用法</h2><p>这一节将对 Libtool 进行更加全面的描述，包括下面的内容 :</p><ul class="ibm-bullet-list"><li>
创建可动态加载模块 ;</li><li>
禁止创建动态或者静态链接库 ;</li><li>
 Libtool 命令模式 ;</li><li>
库版本信息 ;</li></ul><h3 id="minor3.1" class="ibm-h3">创建可动态加载模块</h3><p>有些高级的软件系统在建立时不需要与特定的库链接，而在运行时可以动态加载符合规范的库，来提供额外的功能，这通常称为插件系统。</p><p>可动态加载的库和通常的库有一些区别，它们可以通过 <em>dlopen</em>() 打开，并且可以通过 <em>dlsym</em>() 查询它输出的符号。</p><p>使用 Libtool 可以很容易的建立这样的库，还是以前面的 compress.c 为例，我们可以通过这样的命令建立一个可动态加载模块 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_293806" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ libtool --mode=link&nbsp; gcc -o compress.la compress.lo&nbsp; -rpath /tmp </code></div><div class="line number2 index1 alt1"><code class="htmlscript plain">-lz -module -avoid-version</code></div></div></td></tr></tbody></table></div></div></div></span><p>这里添加了额外的两个参数，-<strong>module</strong>告诉 Libtool 建立一个可动态加载的模块，<strong>-avoid-version</strong>告诉 Libtool 不要添加版本号。</p><p>在 UNIX/Linux 系统中，库通常以 lib 作为前缀，可在上面我们指定的输出文件为 <em>compress.la</em>而不是 libcompress.la，这也是可动态加载模块的一个特征，它不需要遵循通常的库命名规则。</p><p>在实际应用中，可动态加载模块通常会使用主程序提供的一些函数，为了满足动态模块的需求，在编译主程序时，需要添加 <strong>-export-dynamic</strong>选项。</p><h3 id="minor3.2" class="ibm-h3">禁止创建动态或者静态链接库</h3><p>大部分情况下，Libtool 都配置成同时创建动态链接库和静态链接库。可以通过下面的命令查看 Libtool 的当前配置 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_817830" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ libtool – features</code></div></div></td></tr></tbody></table></div></div></div></span><p>它的输出如下 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_997253" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">host: i686-pc-linux-gnu </code></div><div class="line number2 index1 alt1"><code class="htmlscript plain">enable shared libraries </code></div><div class="line number3 index2 alt2"><code class="htmlscript plain">enable static libraries</code></div></div></td></tr></tbody></table></div></div></div></span><p>可是有时侯，只想创建动态链接库或者只想创建静态链接库，这需要修改 Libtool 自身。后面介绍 Libtool 结合 Autoconf 和 Automake 使用时，将有更加简单的办法。</p><a id="4.2.1. 禁止创建动态链接库 |outline"></a><p><strong>禁止创建动态链接库</strong></p><p>Libtool 自身是一个安装在 /usr/bin 目录下的 Shell 脚本，为了修改它，我们需要将它复制到一个有修改权限的目录，然后找到下面的两行 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_662060" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">52 # Whether or not to build shared libraries. </code></div><div class="line number2 index1 alt1"><code class="htmlscript plain">53 build_libtool_libs=yes</code></div></div></td></tr></tbody></table></div></div></div></span><p>将 yes 改为 no。之后用这个修改过的 libtool 就不会创建动态链接库。</p><p>还有其它几个方法可以禁止创建动态链接库，第一个方法是在链接时不提供 -rpath 选项，第二个方法是在链接时使用 <em>-all-static</em>选项，第三个方法是指定目标文件为 libcompress.a 而不是 libcompress.la。</p><a id="4.2.2. 禁止创建静态链接库 |outline"></a><p><strong>禁止创建静态链接库</strong></p><p>在 Libtool 脚本中找到下面两行</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_960578" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">55 # Whether or not to build static libraries. </code></div><div class="line number2 index1 alt1"><code class="htmlscript plain">56 build_old_libs=no</code></div></div></td></tr></tbody></table></div></div></div></span><p>将 yes 改为 no。之后用这个修改过的 libtool 就不会创建静态链接库。</p><h3 id="minor3.3" class="ibm-h3">Libtool 命令模式</h3><p>在前面，我们已经用到了 Libtool 的大部分命令模式，每个命令模式用于不同的阶段，Libtool 根据当前的命令模式添加需要的编译器选项。</p><p>Libtool 支持下面的几个命令模式 :</p><ul class="ibm-bullet-list"><li>
编译模式 ;</li><li>
连接模式 ;</li><li>
安装模式 ;</li><li>
完成模式 ;</li><li>
卸载模式 ;</li><li>
执行模式 ;</li><li>
清除模式 ;</li></ul><p>每个命令模式对应开发中的不同阶段，但并不是在每个项目中都需要使用上面所有的模式，例如一个不需要安装的库就不需要安装和卸载模式。</p><a id="4.3.1. 编译模式 |outline"></a><p><strong>编译模式</strong></p><p>编译模式用于建立从源文件建立对象文件。它需要一个编译器名称作为第一个参数，并且还要提供 -c 选项，Libtool 将根据源文件名称自动选择目标文件名称。如果是建立动态链接库，它也会加入相应的选项，例如 -<em>fPIC</em>等等。</p><p>编译模式使用示例 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_918164" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ libtool --mode=compile gcc -c src.c</code></div></div></td></tr></tbody></table></div></div></div></span><a id="4.3.2. 链接模式 |outline"></a><p><strong>链接模式</strong></p><p>链接模式用于建立 Libtool 库或者可执行文件，如果输出文件名称以 .la 结尾，那么它将尝试建立 Libtool 库。如果输出文件名称以 .a 结尾，它就只建立静态链接库。如果输出文件名称以 .lo 或者 .o 结尾，则建立一个可重新加载的对象文件，这经常叫做部分链接。否则它就建立一个执行文件。</p><p>链接模式使用示例 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_633275" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ libtool --mode=link gcc -o library.la src.lo -rpath /usr/local/lib</code></div></div></td></tr></tbody></table></div></div></div></span><a id="4.3.3. 安装模式 |outline"></a><p><strong>安装模式</strong></p><p>安装模式用于安装 Libtool 库或者执行程序。它的第一个参数必须是 install 或者 cp，之后是要安装的文件以及目标路径。</p><p>安装模式使用示例 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_232051" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ libtool --mode=install install -c library.la /usr/local/lib</code></div></div></td></tr></tbody></table></div></div></div></span><a id="4.3.4. 完成模式 |outline"></a><p><strong>完成模式</strong></p><p>完成模式是在安装完 Libtool 库之后，在使用之前进行适当的配置。finish 模式需要一个参数，即 Libtool 库的安装路径。</p><p>完成模式使用示例 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_233162" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ libtool --mode=finish /usr/local/lib</code></div></div></td></tr></tbody></table></div></div></div></span><a id="4.3.5. 卸载模式 |outline"></a><p><strong>卸载模式</strong></p><p>卸载模式用于卸载已经安装的 Libtool 库或者执行程序。</p><p>卸载模式使用示例 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_838546" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ libtool --mode=uninstall rm /usr/local/lib/library.la</code></div></div></td></tr></tbody></table></div></div></div></span><a id="4.3.6. 执行模式 |outline"></a><p><strong>执行模式</strong></p><p>执行模式用来执行应用程序，它在启动应用程序之前自动的设置好库的路径。</p><p>执行模式使用示例 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_635620" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ libtool --mode=execute gdb program</code></div></div></td></tr></tbody></table></div></div></div></span><a id="4.3.7. 清除模式 |outline"></a><p><strong>清除模式</strong></p><p>清除模式和卸载模式差不多，只是它用来清除开发过程中的中间文件。</p><p>清除模式使用示例 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_450207" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ libtool --mode=clean rm library.la</code></div></div></td></tr></tbody></table></div></div></div></span><h3 id="minor3.4" class="ibm-h3">库版本信息</h3><p>和应用程序一样，库也需要不断的升级，考虑一个第三方应用程序使用了我们之前发布的 libcompress。现在我们对 libcompress 的性能进行了优化，并且提供了新的接口，所以我们又发布了这个新版本。</p><p>这引入了几个问题，如果以前的应用程序采用静态方式链接，那么如果它想使用新库的功能，就必须用新库重新链接应用程序。如果是采用动态链接方式，那么新库安装后，应用程序应该使用新库还是旧库呢？并且，如何避免新库和旧库之间的冲突呢？</p><p>库版本号可以解决上述这些问题，一个动态链接库有一个版本号，它在链接时硬编码到动态链接库中，当一个应用程序链接动态链接库时，它也存储了链接库的版本信息，动态加载器 ( 如 <em>ld-linux.so.2</em>) 可以在程序启动时正确的加载版本匹配的库。</p><p>用 <em>ldd</em>命令可以查看应用程序使用的动态链接库以及它们的版本信息 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_341251" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ ldd .libs/lt-main </code></div><div class="line number2 index1 alt1"><code class="htmlscript plain">linux-gate.so.1 =&gt;&nbsp; (0x00182000) </code></div><div class="line number3 index2 alt2"><code class="htmlscript plain">libcompress.so.0 =&gt; /home/.../.libs/libcompress.so.0 (0x00c25000) </code></div><div class="line number4 index3 alt1"><code class="htmlscript plain">libz.so.1 =&gt; /lib/libz.so.1 (0x00565000) </code></div><div class="line number5 index4 alt2"><code class="htmlscript plain">libc.so.6 =&gt; /lib/libc.so.6 (0x003ad000) </code></div><div class="line number6 index5 alt1"><code class="htmlscript plain">/lib/ld-linux.so.2 (0x0038d000)</code></div></div></td></tr></tbody></table></div></div></div></span><p>我们需要用 .libs/lt-main 作为输入文件，当前目录下的 main 只是一个封装脚本。从上面的输出可以看到，main 程序依赖 libcompress.so 的版本 0。</p><a id="4.4.1. 库接口 |outline"></a><p><strong>库接口</strong></p><p>库接口是 应用程序可以和库交流的入口，常用的库接口包括 :</p><ul class="ibm-bullet-list"><li>
全局变量、结构体、常数 ;</li><li>
全局函数，包括参数类型、数量和返回类型 ;</li><li>
 socket、管道，以及其它进程间通讯的协议格式 ;</li></ul><p>当然还有其它的接口。在设计和实现库时，应该考虑尽量在将来减少库接口的改变。</p><a id="4.4.2. 库版本号 |outline"></a><p><strong>库版本号</strong></p><p>通常一个库有两个版本号，一个主版本号，一个次版本号，主版本号指示接口的改变，次版本号指示性能增强或者错误修复。但不是每个系统都是如此。</p><p>在前面的例子中我们可以看到，为动态链接库 libcompress.so.0.0.0 建立了两个符号链接 :</p><ul class="ibm-bullet-list"><li>
 libcompress.so -&gt; libcompress.so.0.0.0</li><li>
 libcompress.so.0 -&gt; libcompress.so.0.0.0</li></ul><p>其中 libcompress.so 是供链接器 ( 例如 ld) 使用的，它应该指向当前系统中 libcompress 的最新版本，这样新程序总是可以链接最新的库版本。</p><p>libcompress.so.0 是供动态加载器 ( 例如 ld-linux.so.2) 使用的，它应该指向当前系统中相同接口号 ( 这里是 0) 的最新版本，这样动态链接器就可以加载相同接口最新的库版本。</p><a id="4.4.3.Libtool 库版本号 |outline"></a><p><strong>Libtool 库版本号</strong></p><p>每个系统的库版本机制并不一样，Libtool 通过一种抽象的版本机制，最终在创建库时映射到具体的系统版本机制。</p><p>Libtool 的版本号分为 3 个部分 :</p><ul class="ibm-bullet-list"><li><em>current</em>: 表示当前库输出的接口的数量 ;</li><li><em>revision</em>: 表示当前库输出接口的修改次数 ;</li><li><em>age</em>: 表示当前库支持先前的库接口的数量，例如 <em>age</em>为 2，表示它可以和支持当前库接口的执行文件，或者支持前面两个库接口的执行文件进行链接。所以 <em>age</em>应该总是小于或者等于 <em>current</em>。</li></ul><p>Libtool 的库版本通过参数 <strong>-version-info</strong><em>current:revision:age</em>指定，例如下面的例子 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_925527" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ libtool --mode=link gcc -l libcompress.la -version-info 0:1:0</code></div></div></td></tr></tbody></table></div></div></div></span><p>如果没有指定，默认版本是 0.0.0。</p><p>注意，应该尽可能少的更新库版本号，尤其是不能强行将库版本号和软件发行号保持一致，下面是更新库版本号的几个策略 :</p><ul class="ibm-bullet-list"><li>
如果修改了库的源代码，那么应该增加 <em>revision</em>。这是当前接口的新的修订版本。</li><li>
如果改变了接口，应该增加 <em>current</em>，将 <em>revision</em>重置为 0。这是接口的新版本。</li><li>
如果新接口是前面接口的超集 ( 前面的接口还是可用 )，那么应该增加 <em>age</em>。这是一个向后兼容的版本。</li><li>
如果新接口删除了前面接口的元素，那么应该将 <em>age</em>重置为 0。这是一个新的，但是不向后兼容的版本。</li></ul><a id="4.4.4. 避免版本信息 |outline"></a><p><strong>避免版本信息</strong></p><p>有些动态链接库，例如可动态加载模块，不需要版本号，这时可使用 Libtool 的 <strong>-avoid-version</strong>选项，例如下面的命令 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_943395" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ libtool --mode=link gcc -o libcompress.la compress.lo -rpath /tmp -avoid-version</code></div></div></td></tr></tbody></table></div></div></div></span><p>将只会创建一个 .so 结尾的动态链接库，而没有 .0.0.0 这样的版本后缀。</p><h2 id="major4" class="ibm-h2">结合 Autoconf 和 Automake 使用 Libtool</h2><p>在使用 Autoconf 和 Automake 的项目中使用 Libtool 更加容易，只需要添加或者修改几个地方，后续由 Automake 来帮你正确的调用 Libtool。</p><p>和 Autoconf 和 Automake 一样，当在其它主机上编译发布的软件包时，不需要安装 Libtool。</p><p>我们以前面的 compress.c 文件为例，介绍如何将它转换成一个 Autoconf/Automake/Libtool 项目。</p><h3 id="minor4.1" class="ibm-h3">建立 configure.ac</h3><p>使用下面的命令建立一个 configure.ac 模板 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_13758" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ autoscan</code></div></div></td></tr></tbody></table></div></div></div></span><p>这将生成一个 configure.scan 文件，将它改名为 configure.ac。</p><p>在 AC_INIT() 之后加入下面几行 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_351571" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain"># 初始话 Automake </code></div><div class="line number2 index1 alt1"><code class="htmlscript plain">AM_INIT_AUTOMAKE([-Wall]) </code></div><div class="line number3 index2 alt2"><code class="htmlscript plain"># 这是在 Autoconf 中使用 Libtool 唯一必须的宏</code></div><div class="line number4 index3 alt1"><code class="htmlscript plain">AC_PROG_LIBTOOL</code></div></div></td></tr></tbody></table></div></div></div></span><p>在 AC_OUTPUT 之前加入几行 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_643411" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain"># 告诉 Autoconf 通过 Makefile.in 自动生成 Makefile </code></div><div class="line number2 index1 alt1"><code class="htmlscript plain">AC_CONFIG_FILES([Makefile])</code></div></div></td></tr></tbody></table></div></div></div></span><h3 id="minor4.2" class="ibm-h3">建立 Makefile.am</h3><p>建立一个 Makefile.am 文件，内容如下 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_690382" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain"># _LTLIBRARIES 是 Automake 支持 Libtool 的原语</code></div><div class="line number2 index1 alt1"><code class="htmlscript plain">lib_LTLIBRARIES = libcompress.la </code></div><div class="line number3 index2 alt2"><code class="htmlscript plain">libcompress_la_SOURCES = compress.c </code></div><div class="line number4 index3 alt1"><code class="htmlscript plain"># 可以通过 _LDFLAGS 传递选项给 Libtool </code></div><div class="line number5 index4 alt2"><code class="htmlscript plain">libcompress_la_LDFLAGS = </code></div><div class="line number6 index5 alt1"><code class="htmlscript plain"># 通过 _LIBADD 可以指定库依赖关系</code></div><div class="line number7 index6 alt2"><code class="htmlscript plain">libcompress_la_LIBADD&nbsp; = -lz</code></div></div></td></tr></tbody></table></div></div></div></span><p>注意上面用 <em>lib_LTLIBRARIES</em>，而不是 <em>lib_LIBRARIES</em>，这告诉 Automake 使用 Libtool 创建 Libtool 库。</p><h3 id="minor4.3" class="ibm-h3">建立 configure 和 Makefile</h3><p>用下面的命令建立几个空文件 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_900613" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ touch NEWS README AUTHORS ChangeLog</code></div></div></td></tr></tbody></table></div></div></div></span><p>然后运行 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_645681" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ autoreconf -i -s </code></div><div class="line number2 index1 alt1"><code class="htmlscript plain">这将建立 configure 脚本，运行它将得到 Makefile: </code></div><div class="line number3 index2 alt2"><code class="htmlscript spaces">&nbsp;</code><code class="htmlscript plain">$ ./configure</code></div></div></td></tr></tbody></table></div></div></div></span><p>同时，configure 也建立了 libtool 脚本，后续 Automake 将使用这个 libtool 脚本，而不是系统的那个。</p><h3 id="minor4.4" class="ibm-h3">建立 Libtool 库</h3><p>现在已经有了 Makefile，我们只需要简单的输入 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_24017" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ make</code></div></div></td></tr></tbody></table></div></div></div></span><p>便可以创建 libcompress 了，这比手动调用 Libtool 要方便很多。</p><p>注意 Automake 自动为 Libtool 选择了 -rpath 的路径，这是跟随 UNIX 系统习惯定义的，库文件安装到 $prefix/lib 目录中，头文件安装到 $prefix/include 目录中。我们可以通过 configure 脚本的 <em>--prefix</em>选项改变上面的 $prefix，也可以使用 configure 脚本的 <em>--libdir</em>明确的指定库文件的安装目录。</p><a id="5.4.1. 静态库和动态库 |outline"></a><p><strong>静态库和动态库</strong></p><p>前面在 configure.ac 中的 AC_PROG_LIBTOOL 宏为 configure 脚本添加了两个选项 :</p><ul class="ibm-bullet-list"><li>
 --enable-static</li><li>
 --enable-shared</li></ul><p>这两个选项可以控制是否建立动态或者静态链接库，例如，如果只想建立动态链接库，可以这样运行 configure:</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_482645" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ ./configure --enable-shared – disable-static</code></div></div></td></tr></tbody></table></div></div></div></span><p>在开发过程中，禁止创建动态链接库有几个优势 :</p><ul class="ibm-bullet-list"><li>
编译速度提高了，这可以节省时间 ;</li><li>
调试更加容易，因为不用处理任何动态链接库引入的复杂性 ;</li><li>
你可以了解 Libtool 在只支持静态链接库的平台的行为 ;</li></ul><p>为了避免在 configure 时忘记 <em>--disable-shared</em>选项，你可以在 configure.ac 中 AC_PROG_LIBTOOL 之前加入一行 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_39170" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">AC_DISABLE_SHARED</code></div></div></td></tr></tbody></table></div></div></div></span><a id="5.4.2. 可动态加载模块 |outline"></a><p><strong>可动态加载模块</strong></p><p>Libtool 的 链接模式支持 -<em>module</em>选项，它用来建立一个可动态加载模块，可以通过 Automake 将这个选项传递给 Libtool。只需要选项添加到 Makefile.am 中的 <em>libcompress_la_LDFLAGS</em>变量即可，所以，要建立可动态加载模块，我们需要修改 Makefile.am:</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_257717" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">libcompress_la_LDFLAGS = -module -avoid-version</code></div></div></td></tr></tbody></table></div></div></div></span><p>修改 Makefile.am 之后，需要运行 Automake:</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_83467" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ automake</code></div></div></td></tr></tbody></table></div></div></div></span><p>这将重新生成 Makefile.in 文件，以至于 Makefile。</p><a id="5.4.3. 安装 Libtool 库 |outline"></a><p><strong>安装 Libtool 库</strong></p><p>安装 Libtool 库非常的简单，只需要运行 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_95298" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ make install</code></div></div></td></tr></tbody></table></div></div></div></span><a id="5.4.4. 卸载 Libtool 库 |outline"></a><p><strong>卸载 Libtool 库</strong></p><p>和安装 Libtool 库同样简单 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_302634" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ make uninstall</code></div></div></td></tr></tbody></table></div></div></div></span><h3 id="minor4.5" class="ibm-h3">建立执行程序</h3><p>通过 Automake 使用 Libtool 库也非常容易，我们需要在 Makefile.am 中加入下面的几行 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_462471" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">bin_PROGRAMS = main </code></div><div class="line number2 index1 alt1"><code class="htmlscript plain">main_SOURCES = main.c </code></div><div class="line number3 index2 alt2"><code class="htmlscript plain">main_LDFLAGS = </code></div><div class="line number4 index3 alt1"><code class="htmlscript plain">main_LDADD&nbsp;&nbsp; = libcompress.la</code></div></div></td></tr></tbody></table></div></div></div></span><p>注意在建立 libcompress.la 是，我们通过 _LIBADD 指定依赖库，而建立执行文件 main 时，我们通过 _LDADD 指定依赖库，要记住这点区别。</p><p>也记得把前面为测试可动态加载模块时修改的 libcompress_la_LDFLAGS 变量改回来 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_69963" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">libcompress_la_LDFLAGS =</code></div></div></td></tr></tbody></table></div></div></div></span><p>修改 Makefile.am 之后，需要运行 Automake 更新 Makefile.in:</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_149026" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ automake</code></div></div></td></tr></tbody></table></div></div></div></span><p>然后运行</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_671540" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ make</code></div></div></td></tr></tbody></table></div></div></div></span><p>就可以建立可执行程序 main。</p><h3 id="minor4.6" class="ibm-h3">调试执行程序</h3><p>在结合 Autoconf 和 Automake 使用 Libtool 时，我们几乎永远都不会直接调用 Libtool，除了一个例外，那就是 Libtool 的执行模式。</p><p>例如我们在开发时要调试执行程序，可以使用下面的命令 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_114717" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ libtool --mode=execute gdb main</code></div></div></td></tr></tbody></table></div></div></div></span><p>如果直接使用 :</p><span class="dw-code-nohighlight"><div class="ibm-syntax-container"><div><div id="highlighter_772290" class="syntaxhighlighter  htmlscript"><table border="0" cellpadding="0" cellspacing="0" role="none"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="htmlscript plain">$ gdb main</code></div></div></td></tr></tbody></table></div></div></div></span><p>gdb 会抱怨 main 的格式不可接受，因为使用 Libtool 建立的 main 只是一个封装脚本，它最终启动的是 .lib/lt-main。</p><h2 id="major5" class="ibm-h2">小结</h2><p>本文档描述了 GNU Libtool 解决的问题，它的工作方式，以及在实际工作中使用 Libtool 的方法。有兴趣的读者应该进一步参考 GNU Libtool 手册获得更详细的信息。在安装了 GNU Libtool 的系统中可以直接通过 info libtool 来查看手册。</p><!--CMA ID: 499997--><!--Site ID: 10--><!--XSLT stylesheet used to transform this file: dw-document-html-8.0.xsl-->
                                        <!-- Article Quiz -->
                                        
                                        <!-- Article Resources -->
                                        <div class="ibm-alternate-rule"><hr></div><h4 id="artrelatedtopics" class="ibm-h4">相关主题</h4><ul><li>Shared libraries: 这篇 HOWTO 描述了 Linux 系统中动态链接库名字、位置，以及使用动态链接库相关的环境变量，可以在 <a href="http://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html">http://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html</a>查看。</li><li>Autoconf, Automake, Libtool: 这本在线书籍详细描述了 GNU Autotools(Autoconf, Automake, Libtool) 之间的关系，以及如何在软件项目中结合使用 GNU Autotools。可以在 <a href="http://sources.redhat.com/autobook/">http://sources.redhat.com/autobook/</a> 查看本书的在线版本，或者从 <a href="http://sources.redhat.com/autobook/download.html">http://sources.redhat.com/autobook/download.html</a>下载。</li><li>GNU Libtool ：可以在 <a href="http://www.gnu.org/software/libtool/">http://www.gnu.org/software/libtool/</a>从这里可以下载 GNU Libtool 的最新版本，阅读在线手册，或者下载 PDF 版本的手册。</li><li>GNU Autoconf：GNU Autotool 解决了 UNIX 世界大部分常见的软件移植性问题，它通过使用各种手段去探测当前操作系统的特征，以及系统中安装的软件包的特征，最后生成一个头文件，定义各种各样的宏来表示系统的特征。应用程序可以通过这个头文件来针对不同的环境来进行开发。可以在 <a href="http://www.gnu.org/software/autoconf/">http://www.gnu.org/software/autoconf/</a>下载 Autoconf 最新版本的软件包和手册，或者查看在线手册。</li><li>GNU Automake：GNU Automake 解决了编写可移植 Makefile 的问题，它使用和 Makefile 规则不同的语法来描述软件项目的依赖关系。其生成的 Makefile 通常比手工写的 Makefile 更加规范，例如它总是包含 dist, install, uninstall 等等常用的 Makefile target。它支持几种常见的语言，例如 Java, vala 等等。可以在 <a href="http://www.gnu.org/software/automake/">http://www.gnu.org/software/automake/</a>下载 Automake 最新版本的软件包和手册，或者查看在线手册。</li><li><a href="http://www.ibm.com/developerworks/cn/aix/">AIX and UNIX 专区</a>：developerWorks 的“AIX and UNIX 专区”提供了大量与 AIX 系统管理的所有方面相关的信息，您可以利用它们来扩展自己的 UNIX 技能。</li><li><a href="http://www.ibm.com/developerworks/cn/aix/lpsummary.html">AIX and UNIX 专题汇总</a>：AIX and UNIX 专区已经为您推出了很多的技术专题，为您总结了很多热门的知识点。我们在后面还会继续推出很多相关的热门专题给您，为了方便您的访问，我们在这里为您把本专区的所有专题进行汇总，让您更方便的找到您需要的内容。</li><li><a href="http://www.ibm.com/developerworks/cn/aix/downloads/">AIX and UNIX 下载中心</a>：在这里你可以下载到可以运行在 AIX 或者是 UNIX 系统上的 IBM 服务器软件以及工具，让您可以提前免费试用他们的强大功能。</li><li><a href="http://www.ibm.com/developerworks/cn/aix/systemmaga/index.html">IBM Systems Magazine for AIX 中文版</a>：本杂志的内容更加关注于趋势和企业级架构应用方面的内容，同时对于新兴的技术、产品、应用方式等也有很深入的探讨。IBM Systems Magazine 的内容都是由十分资深的业内人士撰写的，包括 IBM 的合作伙伴、IBM 的主机工程师以及高级管理人员。所以，从这些内容中，您可以了解到更高层次的应用理念，让您在选择和应用 IBM 系统时有一个更好的认识。</li></ul>
                                        <!-- Commenting -->
<!-- INLINE_COMMENTS_BEGIN: -->
<div class="ibm-alternate-rule"><hr></div>
<div id="dw-article-cmts-top" class="ibm-columns">
    <div class="ibm-col-6-2">
        <h4 id="icomments" class="ibm-h4">评论</h4>
        <div id="dw-article-cmts-login">
            <p>添加或订阅评论，请先<a onclick="window.location=userLinks[0].url;" tabindex="0" role="link">登录</a>或<a onclick="window.location=userLinks[1].url;" tabindex="0" role="link">注册</a>。</p>
        </div>
    </div>    
    <div class="ibm-col-6-2" id="dw-notify"> 
        <input type="checkbox" value="1" name="comment_notification" id="comment_notification" disabled="">
        <label for="comment_notification" style="color: rgb(204, 204, 204);">有新评论时提醒我</label>	   
    </div>
</div>

<div class="dw-article-cmts-container">       
    <div class="ibm-no-print jquery-comments read-only" id="dw-icomments-container"><div class="commenting-field main"><img src="./使用 GNU Libtool 创建库_files/user-icon.png" alt="" class="profile-picture round by-current-user"><div class="textarea-wrapper"><span class="close" style="display: none;"><span class="left"></span><span class="right"></span></span><div class="textarea" data-placeholder="添加评论" contenteditable="true" style="height: 3.65em;"></div><div class="control-row" style="display: none;"><span class="send save highlight-background">提交</span></div></div></div><ul class="navigation"><div class="navigation-wrapper"><li data-sort-key="newest" data-container-name="comments" class="active">最新的</li><li data-sort-key="oldest" data-container-name="comments">历史</li><li data-sort-key="popularity" data-container-name="comments">热门</li></div><div class="navigation-wrapper responsive"><li class="title active"><header>最新的</header></li><ul class="dropdown"><li data-sort-key="newest" data-container-name="comments" class="active">最新的</li><li data-sort-key="oldest" data-container-name="comments">历史</li><li data-sort-key="popularity" data-container-name="comments">热门</li></ul></div></ul><div class="data-container" data-container="comments"><ul id="comment-list" class="main"><li data-id="10233" class="comment"><div class="comment-wrapper"><img src="./使用 GNU Libtool 创建库_files/user-icon.png" alt="" class="profile-picture round"><time data-original="1326535200000">2012 年 01 月 14 日</time><div class="name"><a href="https://www.ibm.com/developerworks/community/profiles/user/xuechao">xuechao</a></div><div class="wrapper"><div class="content">简明易懂，非常好！</div><span class="actions"><button class="action reply" type="button">回复</button><span class="separator">·</span><button class="action upvote"><span class="upvote-count">0</span><i class="fa fa-thumbs-up"></i></button><span class="separator">·</span><a class="action reply" href="https://www.ibm.com/developerworks/community/report?lang=cn&amp;referingURL=https%3A%2F%2Fwww.ibm.com%2Fdeveloperworks%2Fcn%2Faix%2Flibrary%2F1007_wuxh_libtool%2Findex.html&amp;mymessage=%E8%AF%84%E8%AE%BA%3A%20%E7%AE%80%E6%98%8E%E6%98%93%E6%87%82%EF%BC%8C%E9%9D%9E%E5%B8%B8%E5%A5%BD%EF%BC%81%0D%E7%94%B1%20xuechao%20%20%E4%BA%8E%202012%20%E5%B9%B4%2001%20%E6%9C%88%2014%20%E6%97%A5%20%0D%0D---%20%E5%9C%A8%E4%B8%8B%E6%96%B9%E6%B7%BB%E5%8A%A0%E8%AF%84%E8%AE%BA%20---" target="_blank">报告滥用<i class="fa image" style="background-image: url(&quot;/developerworks/maverick/image/report-abuse.png&quot;);"></i></a></span></div></div><ul class="child-comments"></ul></li><li data-id="10232" class="comment"><div class="comment-wrapper"><img src="./使用 GNU Libtool 创建库_files/user-icon.png" alt="" class="profile-picture round"><time data-original="1311235200000">2011 年 07 月 21 日</time><div class="name"><a href="https://www.ibm.com/developerworks/community/profiles/user/%E5%90%B4%E5%B0%8F%E8%99%8E">吴小虎</a></div><div class="wrapper"><div class="content">LT_INIT 使用起来是要方便一些，比如有版本检查，禁止动态\/静态库的选项(如果用 AC_PROG_LIBTOOL 则要额外的宏)。在 http:\/\/www.gnu.org\/software\/libtool\/manual\/html_node\/LT_005fINIT.html 提到可以使用 autoupdate 更新。</div><span class="actions"><button class="action reply" type="button">回复</button><span class="separator">·</span><button class="action upvote"><span class="upvote-count">0</span><i class="fa fa-thumbs-up"></i></button><span class="separator">·</span><a class="action reply" href="https://www.ibm.com/developerworks/community/report?lang=cn&amp;referingURL=https%3A%2F%2Fwww.ibm.com%2Fdeveloperworks%2Fcn%2Faix%2Flibrary%2F1007_wuxh_libtool%2Findex.html&amp;mymessage=%E8%AF%84%E8%AE%BA%3A%20LT_INIT%20%E4%BD%BF%E7%94%A8%E8%B5%B7%E6%9D%A5%E6%98%AF%E8%A6%81%E6%96%B9%E4%BE%BF%E4%B8%80%E4%BA%9B%EF%BC%8C%E6%AF%94%E5%A6%82%E6%9C%89%E7%89%88%E6%9C%AC%E6%A3%80%E6%9F%A5%EF%BC%8C%E7%A6%81%E6%AD%A2%E5%8A%A8%E6%80%81%5C%2F%E9%9D%99%E6%80%81%E5%BA%93%E7%9A%84%E9%80%89%E9%A1%B9(%E5%A6%82%E6%9E%9C%E7%94%A8%20AC_PROG_LIBTOOL%20%E5%88%99%E8%A6%81%E9%A2%9D%E5%A4%96%E7%9A%84%E5%AE%8F)%E3%80%82%E5%9C%A8%20http%3A%5C%2F%5C%2Fwww.gnu.org%5C%2Fsoftware%5C%2Flibtool%5C%2Fmanual%5C%2Fhtml_node%5C%2FLT_005fINIT.html%20%E6%8F%90%E5%88%B0%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%20autoupdate%20%E6%9B%B4%E6%96%B0%E3%80%82%0D%E7%94%B1%20%E5%90%B4%E5%B0%8F%E8%99%8E%20%20%E4%BA%8E%202011%20%E5%B9%B4%2007%20%E6%9C%88%2021%20%E6%97%A5%20%0D%0D---%20%E5%9C%A8%E4%B8%8B%E6%96%B9%E6%B7%BB%E5%8A%A0%E8%AF%84%E8%AE%BA%20---" target="_blank">报告滥用<i class="fa image" style="background-image: url(&quot;/developerworks/maverick/image/report-abuse.png&quot;);"></i></a></span></div></div><ul class="child-comments"></ul></li><li data-id="10231" class="comment"><div class="comment-wrapper"><img src="./使用 GNU Libtool 创建库_files/user-icon.png" alt="" class="profile-picture round"><time data-original="1297764000000">2011 年 02 月 15 日</time><div class="name"><a href="https://www.ibm.com/developerworks/community/profiles/user/zhangsen">zhangsen</a></div><div class="wrapper"><div class="content">根据 http:\/\/www.gnu.org\/software\/libtool\/manual\/html_node\/LT_005fINIT.html, libtool 的初始化是LT_INIT, AC_PROG_LIBTOOL and AM_PROG_LIBTOOL are deprecated names for older versions of this macro.</div><span class="actions"><button class="action reply" type="button">回复</button><span class="separator">·</span><button class="action upvote"><span class="upvote-count">0</span><i class="fa fa-thumbs-up"></i></button><span class="separator">·</span><a class="action reply" href="https://www.ibm.com/developerworks/community/report?lang=cn&amp;referingURL=https%3A%2F%2Fwww.ibm.com%2Fdeveloperworks%2Fcn%2Faix%2Flibrary%2F1007_wuxh_libtool%2Findex.html&amp;mymessage=%E8%AF%84%E8%AE%BA%3A%20%E6%A0%B9%E6%8D%AE%20http%3A%5C%2F%5C%2Fwww.gnu.org%5C%2Fsoftware%5C%2Flibtool%5C%2Fmanual%5C%2Fhtml_node%5C%2FLT_005fINIT.html%2C%20libtool%20%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96%E6%98%AFLT_INIT%2C%20AC_PROG_LIBTOOL%20and%20AM_PROG_LIBTOOL%20are%20deprecated%20names%20for%20older%20versions%20of%20this%20macro.%0D%E7%94%B1%20zhangsen%20%20%E4%BA%8E%202011%20%E5%B9%B4%2002%20%E6%9C%88%2015%20%E6%97%A5%20%0D%0D---%20%E5%9C%A8%E4%B8%8B%E6%96%B9%E6%B7%BB%E5%8A%A0%E8%AF%84%E8%AE%BA%20---" target="_blank">报告滥用<i class="fa image" style="background-image: url(&quot;/developerworks/maverick/image/report-abuse.png&quot;);"></i></a></span></div></div><ul class="child-comments"></ul></li></ul><div class="no-comments no-data"><i class="fa fa-comments fa-2x"></i><br>第一个评论</div></div></div>
</div>
<!-- INLINE_COMMENTS_END -->                                        <!-- CENTER_6_4_CONTENT_COLUMN_END -->
                                    </div>   
                                </div>
                        <!--Rating_Meta_BEGIN--><div class="metavalue">static.content.url=http://www.ibm.com/developerworks/js/artrating/</div><div class="metavalue">SITE_ID=10</div><div class="metavalue">Zone=AIX and UNIX</div><div class="metavalue">ArticleID=499997</div><div class="metavalue">ArticleTitle=使用 GNU Libtool 创建库</div><div class="metavalue">publish-date=07122010</div><script language="javascript" type="text/javascript">document.write('<div class="metavalue">url='+location.href.replace(/</g,  '%3C')+'</div>');</script><div class="metavalue">url=https://www.ibm.com/developerworks/cn/aix/library/1007_wuxh_libtool/index.html</div><!--Rating_Meta_END-->
                    </div>
                    <!-- END_IBM-CONTENT-MAIN -->
                </div>
                <!-- END_IBM-CONTENT-BODY -->
            </div>
            <!-- END_IBM-CONTENT -->
        </div>
        <!-- END_IBM-PCON -->
    </main>
    <!-- MAIN_CONTENT_END -->
    
    <!-- END_CONTENT-WRAPPER -->	
</div>
<!-- FOOTER_BEGIN -->
<footer role="contentinfo" aria-label="IBM developerWorks">
    <div id="dw-footer-module" class="dw-footer-home">
        <section aria-label="参考资料" role="contentinfo">
            <div class="ibm-columns">
                <div class="ibm-col-6-1 dw-footer-col-1">
                    <ul>
                        <li class="dw-footer-heading" aria-label="developerWorks">developerWorks</li>
                        <li><a href="https://www.ibm.com/developerworks/secure/feedback.jsp?domain=dwchina">站点反馈</a></li>
                        <li class="dw-footer-newline"><a href="https://www.ibm.com/developerworks/secure/myideas2.jsp?domain=dwchina">我要投稿</a></li>
                        <li class="dw-footer-newline"><a href="https://www.ibm.com/developerworks/cn/author/">投稿指南</a></li>
                        <li class="dw-footer-newline"><a href="https://www.ibm.com/developerworks/community/report?lang=zh">报告滥用</a></li>
                        <li class="dw-footer-newline"><a href="https://www.ibm.com/developerworks/cn/community/terms/thirdparty/">第三方提示</a></li>
                    </ul>
                    <ul>
                        <li class="dw-footer-newline"><a href="https://weibo.com/ibmdw/">关注微博</a></li>
                    </ul>
                </div>
                <div class="ibm-col-6-1 dw-footer-col-2">
                    <ul>
                        <li class="dw-footer-heading" aria-label="加入">加入</li>
                        <li class="dw-footer-newline"><a href="https://www.ibm.com/partnerworld/isv/">ISV 资源 (英语)</a></li>
                        <li class="dw-footer-newline"><a href="https://www-31.ibm.com/ibm/cn/ur/">大学合作</a></li>
                    </ul>
                    <ul class="dw-footer-lang" aria-label="选择语言">
                        <li class="dw-footer-heading">选择语言</li>
                        <li><a href="https://www.ibm.com/developerworks/">English</a></li>
                        <li><a href="https://www.ibm.com/developerworks/cn/" lang="zh">中文</a></li>
                        <li><a href="https://www.ibm.com/developerworks/jp/" lang="ja">日本語</a></li>
                        <li><a href="https://www.ibm.com/developerworks/ru/" lang="ru">Русский</a></li>
                        <li class="dw-footer-newline"><a href="https://www.ibm.com/developerworks/br/" lang="pt">Português (Brasil)</a></li>
                        <li><a href="https://www.ibm.com/developerworks/ssa/" lang="es">Español</a></li>
                        <li><a href="https://developer.ibm.com/kr/" lang="kr">한글</a></li>
                    </ul>
                </div>
                <div class="ibm-col-6-1 dw-footer-col-3"> </div>
                <div class="ibm-col-6-1 dw-footer-col-4">
                    <ul class="dw-footer-categories">
                        <li class="dw-footer-category">
                            <a href="https://www.ibm.com/developerworks/cn/views/global/libraryview.jsp">技术文档库</a>
                        </li>
                        <li class="dw-footer-category">
                            <a href="http://ibmdeveloperworks.mkt6741.com/developerWorksChina-NewsletterSubscriptionPage/">dW 中国时事通讯</a>  
                        </li>
                        <li class="dw-footer-category">
                            <a href="https://developer.ibm.com/cn/dwblog/">博客</a>  
                        </li>
                        <li class="dw-footer-category">
                            <a href="https://developer.ibm.com/cn/events/">活动</a>  
                        </li>
                    </ul>
                </div>
                <div class="ibm-col-6-1 dw-footer-col-5">
                    <ul class="dw-footer-categories">
                        <li class="dw-footer-category">
                            <a href="https://www.ibm.com/developerworks/cn/community/">社区</a>  
                        </li>
                        <li class="dw-footer-category">
                            <a href="https://developer.ibm.com/cn/">开发者中心</a>  
                        </li>
                        <li class="dw-footer-category">
                            <a href="https://developer.ibm.com/cn/tv/">视频</a>  
                        </li>
                        <li class="dw-footer-category">
                            <a href="https://www.ibm.com/developerworks/cn/rss/">订阅源</a>  
                        </li>

                    </ul>
                </div>
                <div class="ibm-col-6-1 dw-footer-col-6">
                    <ul class="dw-footer-categories">
                        <li class="dw-footer-category">
                            <a href="https://www.ibm.com/developerworks/cn/downloads/">软件下载</a>  
                        </li>
                        <li class="dw-footer-category">
                            <a href="https://developer.ibm.com/cn/journey/">Code patterns</a>  
                        </li>
                    </ul>
                </div>
            </div>
        </section>
    </div>
    <div id="dw-footer" class="ibm-padding-normal ibm-alternate">
        <div class="ibm-columns">
            <div class="ibm-col-1-1">
                <div class="dw-footer-corporate-links">
                <ul>
                    <li><a href="https://www.ibm.com/contact/cn/zh/">联系 IBM</a></li>
                    <li><a href="https://www.ibm.com/privacy/cn/zh/">隐私条约</a></li>
                    <li><a href="https://www.ibm.com/developerworks/community/terms?lang=zh">使用条款</a></li>
                    <li><a href="https://www.ibm.com/accessibility/cn/zh/">信息无障碍选项</a></li>
                    <li class="ibm-feedbacklink"><a href="https://www.ibm.com/developerworks/cn/aix/library/1007_wuxh_libtool/index.html#">反馈</a></li>
                    <li id="ibm-truste-cp"><a onclick="truste.eu.clickListener();return false;" href="https://www.ibm.com/developerworks/cn/aix/library/1007_wuxh_libtool/index.html#">Cookie 首选项</a></li>
                </ul>                 
                </div>    
            </div>
        </div>
    </div>        
</footer> <!-- FOOTER_END -->

<!-- END_IBM-TOP -->
</div>

<!-- SCRIPTS_INCLUDE_BEGIN -->
<!-- Styles -->
<link rel="stylesheet" type="text/css" href="./使用 GNU Libtool 创建库_files/jquery-comments.css">
<link rel="stylesheet" href="./使用 GNU Libtool 创建库_files/font-awesome.min.css">

<!-- Libraries -->
<script type="text/javascript" src="./使用 GNU Libtool 创建库_files/jquery-comments.min.js"></script>
<script type="text/javascript" src="./使用 GNU Libtool 创建库_files/moment-with-locales.js"></script>
<script type="text/javascript" src="./使用 GNU Libtool 创建库_files/ContentComments.js"></script>
<script type="text/javascript" src="./使用 GNU Libtool 创建库_files/ContentCommentsFormatter.js"></script>
<script type="text/javascript" language="JavaScript">

	IBMCore.common.module.masthead.subscribe("ready", "customjs", setupCommentsPlugin).runAsap(setupCommentsPlugin);

	function setupCommentsPlugin(){
		//debugger;
			//alert(userLinks);
			var commentsInitInfo = {
				contentId : $("div[class=metavalue]:contains('ArticleID=')").text().split("=")[1],
				siteId :  $("div[class=metavalue]:contains('SITE_ID=')").text().split("=")[1],
				pluginDivId : '#dw-icomments-container',
				notifyElementId : "#comment_notification",
				loginMessageDivId : "#dw-article-cmts-login",
				totalCommentsDivId : "#nCmts",
						isIdea:false

			};				
								
			ContentComments.Setup(commentsInitInfo);
	}
</script>

<!-- SCRIPTS_INCLUDE_END -->



<div id="ibm-overlay-backdrop"></div><div id="ibm-mobilemenu-screen"></div><div id="teconsent" class="truste_cookie_prefs" style="position: fixed; display: none; height: 40px; background-color: #ffffff; z-index: 9999999999; bottom: 0; right: 0; margin: 0; padding: 0 16px; line-height: 40px; vertical-align: middle; box-shadow:0 0 10px 3px rgba(0,0,0,.1)" consent="undefined"><script type="text/javascript" src="./使用 GNU Libtool 创建库_files/notice" id="truste_0.5044817009330829"></script><script async="async" type="text/javascript" crossorigin="" src="./使用 GNU Libtool 创建库_files/1.9"></script><a id="icon-id05977656222203496" tabindex="0" role="button" lang="en" style="cursor: pointer; font-family: ibm-plex-sans; font-size: 12pt; color: #3d3d3d; text-decoration: none">Cookie Preferences</a></div><iframe name="_hjRemoteVarsFrame" title="_hjRemoteVarsFrame" id="_hjRemoteVarsFrame" src="./使用 GNU Libtool 创建库_files/rcj-99d43ead6bdf30da8ed5ffcb4f17100c.html" style="display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;"></iframe><script src="./使用 GNU Libtool 创建库_files/js(1)" id="mm_pp_background"></script><div id="ads"></div><iframe src="./使用 GNU Libtool 创建库_files/iframe.html" id="mm_batch_supply_background" style="visibility: hidden; display: none;"></iframe><iframe src="./使用 GNU Libtool 创建库_files/iframe(1).html" id="mm_sync_back_ground" style="visibility: hidden; display: none;"></iframe></body></html>